%h2 There #{is_pluralize(Shift.all.length, 'shift')}

= render 'shared/shift_error_messages'

%h3 All Shifts
= link_to 'Trigger outdater', trigger_outdater_admin_shifts_path, method: :put, class: 'btn btn-danger'

= will_paginate @shifts, :param_name => 'shifts_page'
%table.table.table-striped.table-bordered.table-hover
  %tr
    %th full name
    %th day_work
    %th status
    %th Delete
    %th Approve
    %th Reject
    %th Put Pending
    %th History change
    - @shifts.each do |shift|
      %tr
        %td= shift.user.full_name
        %td= shift.day_work
        %td{:class => "#{shift.status}"}
          = shift.status
        %td
          - if shift.is_shift_pending? || shift.is_shift_outdated?
            = link_to admin_shift_path(shift.id), method: :delete, data: {confirm: 'Are you sure to delete?'}, class: "btn btn-default" do
              %span.glyphicon.glyphicon-trash
        %td
          - if shift.is_shift_pending? && !shift.day_work.past?
            = link_to approve_admin_shift_path(shift.id), method: :put, class: "btn btn-success", "data-no-turbolink" => true do
              %span.glyphicon.glyphicon-ok
        %td
          - if shift.is_shift_pending? && !shift.day_work.past?
            = link_to reject_admin_shift_path(shift.id), method: :put, class: "btn btn-danger", "data-no-turbolink" => true do
              %span.glyphicon.glyphicon-remove
        %td
          - if !shift.is_shift_pending? && !shift.day_work.past? && current_user.is_admin?
            = link_to become_pending_admin_shift_path(shift.id), method: :put, class: "btn btn-default", "data-no-turbolink" => true do
              %span.glyphicon.glyphicon-question-sign
        %td
          - if shift.shift_decisions.exists?
            = link_to history_status_admin_shift_path(shift.id), class: "btn btn-default", "data-no-turbolink" => true do
              %span.glyphicon.glyphicon-list-alt
= will_paginate @shifts, :param_name => 'shifts_page'

= render 'admin/shift_decisions/index', collection: @shiftdecisions
